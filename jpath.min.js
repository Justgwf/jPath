(function(U,o,v){var N=!0,D=!1,V="undefined",E="string",O="function",F=".",G='',H='g',P=new RegExp("([A-Za-z0-9_\\*@]+(?:\\[.+?\\])?)",H),I=new RegExp("(\\S+)\\[(\\d+)\\]"),J=new RegExp("([\\w@\\.]+)\\s*([~><\\^\\*\\$\\!=]=?|\\?)\\s*([@\\w\\s_\\'\$\\.\\+]+)(\\s*|$)",H),K=new RegExp("(\\S+)\\[(.+)\\]"),Q=new RegExp("^\\s\\s*"),R=new RegExp("\\s\\s*$"),L=o.prototype.push,S=o.prototype.concat,k={trim:function(a){return a.replace(Q,G).replace(R,G)},toArray:function(a){return a instanceof o?a:(a===v||a===null)?[]:[a]},traverse:function(d,r,b){var T,h=(b||this.data),j,w,e,x,y,z,A,i,m=arguments.callee,p,l,M,s;if(h&&typeof(d)===E){w=d.match(P);e=w[0];i=w.slice(1).join(F);if(h instanceof o){j=[];for(l=0,s=h.length;s>l;l++){M=h[l];p=m.apply(this,[e,null,M]);if(((p instanceof o)&&p.length)||p!==v){L.apply(j,[p])}}if(j.length){return i?m.apply(this,[i,null,j]):j}else{return}}else if(e==="*"){return i?m.apply(this,[i,null,h]):h}else if(h[e]!==v){return i?m.apply(this,[i,null,h[e]]):h[e]}else if(I.test(e)){x=e.match(I);e=x[1];y=+x[2];return i?m.apply(this,[i,null,h[e][y]]):h[e][y]}else if(K.test(e)){z=e.match(K);e=z[1];A=z[2];var t,u,B=h[e],n;if(B instanceof o){j=[];for(l=0,s=B.length;s>l;l++){n=B[l];t=A.replace(J,function(a,c,f,g){return k.testPairs.apply(n,[c,g,f,r])});u=eval(t);if(u){L.apply(j,[n])}}if(j.length){return i?m.apply(this,[i,null,j]):j}else{return}}else{n=h;t=A.replace(J,function(a,c,f,g){return k.testPairs.apply(n,[c,g,f,r])});u=eval(t);if(u){return i?m.apply(this,[i,null,n]):n}}}}return T},matchTypes:function(a,c){var f,g;switch(typeof(a)){case E:g=c+'';break;case"boolean":g=c==="true"?N:D;break;case"number":g=+c;break;case"date":g=new Date(c).valueOf();f=a.valueOf();break;default:g=c}if(c==="null"){g=null}if(c==="undefined"){g=void(0)}return{left:(f||a),right:g}},testPairs:function(a,c,f,g){var d=D,r=a.indexOf(F)!==-1?k.traverse(a,null,this):this[a],b=k.matchTypes(r,k.trim(c));switch(f){case"=":d=(b.left===b.right);break;case"==":d=(b.left===b.right);break;case"!=":d=(b.left!==b.right);break;case"^=":d=(b.left+'').indexOf(b.right)===0;break;case"<":d=(b.left<b.right);break;case"<=":d=(b.left<=b.right);break;case">":d=(b.left>b.right);break;case">=":d=(b.left>=b.right);break;case"~=":d=((b.left+'').toLowerCase()===(b.right+'').toLowerCase());break;case"$=":d=new RegExp(b.right+"$","i").test(b.left);break;case"*=":d=(b.left+'').indexOf(b.right)!==-1;break;case"?":if(typeof(g)===O){d=g.call(this,a,c)}break}return d},merge:function(a){var c=[],f=k.toArray(a?k.traverse.apply(this,arguments):this.selection);c=S.apply([],f);return c}},C={};function q(a){if(!(this instanceof q)){return new q(a)}this.data=a||null;this.selection=[]}q.prototype={from:function(a){this.data=a;return this},first:function(){return this.selection.length?this.selection[0]:null},last:function(){return this.selection.length?this.selection.slice(-1)[0]:null},eq:function(a){return this.selection.length?this.selection[a]:null},select:function(a,c,f){this.selection=k.merge.apply(this,arguments);return this},and:function(a){this.selection=this.selection.concat(k.merge.apply(this,arguments));return this},val:function(){return this.selection}};C.select=function(a,c,f){return q(a).select(c,null,f)};C.filter=function(a,c,f){return q(a).select(c,null,f).val()};window.jPath=window.jPath||C})(document,Array);
