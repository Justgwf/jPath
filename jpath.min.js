(function(Q,o,v,w){var M=!0,E=!1,R="undefined",F="string",G=".",N=new RegExp("([A-Za-z0-9_\\*@]+(?:\\[.+?\\])?)","g"),H=new RegExp("(\\S+)\\[(\\d+)\\]"),I=new RegExp("([\\w@\\.]+)\\s*([~><\\^\\*\\$\\!=]=?|\\?)\\s*([@\\w\\s_\\'\$\\.\\+]+)(\\s*|$)","g"),J=new RegExp("(\\S+)\\[(.+)\\]"),K=o.prototype.push,O=o.prototype.concat,k={toArray:function(a){return a instanceof o?a:(a===w||a===null)?[]:[a]},traverse:function(d,r,b){var P,h=(b||this.data),j,x,e,y,z,A,B,i,m=arguments.callee,p,l,L,s;if(h&&typeof(d)===F){x=d.match(N);e=x[0];i=x.slice(1).join(G);if(h instanceof o){j=[];for(l=0,s=h.length;s>l;l++){L=h[l];p=m.apply(this,[e,null,L]);if(((p instanceof o)&&p.length)||p!==w){K.apply(j,[p])}}if(j.length){return i?m.apply(this,[i,null,j]):j}else{return}}else if(e==="*"){return i?m.apply(this,[i,null,h]):h}else if(h[e]!==w){return i?m.apply(this,[i,null,h[e]]):h[e]}else if(H.test(e)){y=e.match(H);e=y[1];z=+y[2];return i?m.apply(this,[i,null,h[e][z]]):h[e][z]}else if(J.test(e)){A=e.match(J);e=A[1];B=A[2];var t,u,C=h[e],n;if(v.isArray(C)){j=[];for(l=0,s=C.length;s>l;l++){n=C[l];t=B.replace(I,function(a,c,f,g){return k.testPairs.apply(n,[c,g,f,r])});u=eval(t);if(u){K.apply(j,[n])}}if(j.length){return i?m.apply(this,[i,null,j]):j}else{return}}else{n=h;t=B.replace(I,function(a,c,f,g){return k.testPairs.apply(n,[c,g,f,r])});u=eval(t);if(u){return i?m.apply(this,[i,null,n]):n}}}}return P},matchTypes:function(a,c){var f,g;switch(typeof(a)){case F:g=c+'';break;case"boolean":g=c==="true"?M:E;break;case"number":g=+c;break;case"date":g=new Date(c).valueOf();f=a.valueOf();break;default:g=c}if(c==="null"){g=null}if(c==="undefined"){g=void(0)}return{left:(f||a),right:g}},testPairs:function(a,c,f,g){var d=E,r=a.indexOf(G)!==-1?k.traverse(a,null,this):this[a],b=k.matchTypes(r,v.trim(c));switch(f){case"=":d=(b.left===b.right);break;case"==":d=(b.left===b.right);break;case"!=":d=(b.left!==b.right);break;case"^=":d=(b.left+'').indexOf(b.right)===0;break;case"<":d=(b.left<b.right);break;case"<=":d=(b.left<=b.right);break;case">":d=(b.left>b.right);break;case">=":d=(b.left>=b.right);break;case"~=":d=((b.left+'').toLowerCase()===(b.right+'').toLowerCase());break;case"$=":d=new RegExp(b.right+"$","i").test(b.left);break;case"*=":d=(b.left+'').indexOf(b.right)!==-1;break;case"?":if(v.isFunction(g)){d=g.call(this,a,c)}break}return d},merge:function(a){var c=[],f=k.toArray(a?k.traverse.apply(this,arguments):this.selection);c=O.apply([],f);return c}},D={};function q(a){if(!(this instanceof q)){return new q(a)}this.data=a||null;this.selection=[]}q.prototype={from:function(a){this.data=a;return this},first:function(){return this.selection.length?this.selection[0]:null},last:function(){return this.selection.length?this.selection.slice(-1)[0]:null},eq:function(a){return this.selection.length?this.selection[a]:null},select:function(a,c,f){this.selection=k.merge.apply(this,arguments);return this},and:function(a){this.selection=this.selection.concat(k.merge.apply(this,arguments));return this},val:function(){return this.selection}};D.select=function(a,c,f){return q(a).select(c,null,f)};D.filter=function(a,c,f){return q(a).select(c,null,f).val()};window.jPath=window.jPath||D})(document,Array,jQuery);
